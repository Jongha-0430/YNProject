<!-- src/main/resources/templates/fragments/commute.html -->
<!-- 출퇴근 모달창 -->
<div th:fragment="commute">
    <div class="modal fade" id="attendanceModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">출근</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div id="currentTime">현재 시간:</div>
                    출근하시겠습니까?
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" id="attendanceConfirmButton" data-bs-dismiss="modal">네
                    </button>
                    <button type="button" class="btn btn-secondary" id="attendanceCancelButton" data-bs-dismiss="modal">
                        아니오
                    </button>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="leaveworkModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">퇴근</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div id="currentTimes">현재 시간:</div>
                    퇴근하시겠습니까?
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" id="leaveworkConfirmButton" data-bs-dismiss="modal">네
                    </button>
                    <button type="button" class="btn btn-secondary" id="leaveworkCancelButton" data-bs-dismiss="modal">
                        아니오
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // 출퇴근 Modal용
        document.addEventListener('DOMContentLoaded', function () {
            function updateTime(elementId) {
                const currentTimeElement = document.getElementById(elementId);
                const now = new Date();
                const hours = now.getHours().toString().padStart(2, '0');
                const minutes = now.getMinutes().toString().padStart(2, '0');
                const seconds = now.getSeconds().toString().padStart(2, '0');
                currentTimeElement.textContent = `현재 시간: ${hours}:${minutes}:${seconds}`;
            }

            function setupModal(modalId, confirmButtonId, cancelButtonId, message, switchInput, checkedState) {
                const modalElement = document.getElementById(modalId);
                const confirmButton = document.getElementById(confirmButtonId);
                const cancelButton = document.getElementById(cancelButtonId);

                $(modalElement).on('show.bs.modal', function () {
                    updateTime(modalId === 'attendanceModal' ? 'currentTime' : 'currentTimes');
                });

                confirmButton.addEventListener('click', function () {
                    switchInput.checked = checkedState;
                    alert(message);
                });

                cancelButton.addEventListener('click', function () {
                    switchInput.checked = !checkedState;
                });
            }

            const switchInput = document.getElementById('flexSwitchCheckDefault');
            const commuteIcon = document.getElementById('commuteIcon');

            commuteIcon.addEventListener('click', function () {
                if (switchInput.checked) {
                    $('#attendanceModal').modal('show');
                } else {
                    $('#leaveworkModal').modal('show');
                }
            });

            setupModal('attendanceModal', 'attendanceConfirmButton', 'attendanceCancelButton', '출근되었습니다!', switchInput, true);
            setupModal('leaveworkModal', 'leaveworkConfirmButton', 'leaveworkCancelButton', '퇴근되었습니다!', switchInput, false);

            setInterval(function () {
                updateTime('currentTime');
                updateTime('currentTimes');
            }, 1000);
        });
    </script>
</div>